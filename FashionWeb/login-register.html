<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel='stylesheet'
        href='https://cdn-uicons.flaticon.com/3.0.0/uicons-regular-straight/css/uicons-regular-straight.css'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <link rel="stylesheet" href="assets/css/style.css">
    <script src="assets/js/products.js"></script>
    <link rel="icon" href="assets/img/ChatGPT-Image-Jun-14_-2025_-02_08_38-PM.svg">
    <title>ITLife Shop</title>
</head>

<body>
    <header class="header">
        <div>
            <div class="top-session">
                <div class="left-session">
                    <a href="home.html"><img src="assets/img/ChatGPT-Image-Jun-14_-2025_-02_08_38-PM.svg" class="logo"
                            alt=""></a>
                </div>
                <div class="header__search">
                    <input id="search-input" class="search-bar form__input" type="text" placeholder="Tìm kiếm...">
                    <button class="search-btn"><img src="assets/img/search-svgrepo-com.svg" alt=""
                            class="search-icon"></button>
                    <div id="search-results" class="search__dropdown"></div>
                </div>
                <div class="right-session">
                    <a href="wishlist.html" class="header__action-btn">
                        <img src="assets/img/icon-heart.svg" alt="">
                        <span class="count"></span>
                    </a>
                    <a href="cart.html" class="header__action-btn">
                        <img src="assets/img/icon-cart.svg" alt="">
                        <span class="count"></span>
                    </a>
                    <a href="login-register.html" class="account__btn">
                        <img src="assets/img/account-svgrepo-com.svg" alt="">
                    </a>
                </div>
            </div>
            <div class="bottom-session">
                <div class="category">
                    <ul class="category-list">
                        <li><a href="home.html" class="category-link">Trang chủ</a></li>
                        <li><a href="shop.html" class="category-link">Sản phẩm</a></li>
                        <li><a href="accounts.html" class="category-link">Tài khoản của tôi</a></li>
                        <li><a href="compare.html" class="category-link">So sánh</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>
    <main class="main">
        <section class="breadcrumb">
            <ul class="breadcrumb__list flex container">
                <li><a href="home.html" class="breadcrumb__link">Trang chủ</a></li>
                <li><span class="breadcrumb__link">></span></li>
                <li><span class="breadcrumb__link">Đăng nhâp/Đăng ký</span></li>
            </ul>
        </section>
        <section class="login-register section--lg">
            <div class="login-register__container container grid">
                <div class="login">
                    <h3 class="section__title">Đăng nhập</h3>
                    <form onsubmit="login(event)" class="form grid" id="login-form">
                        <input type="email" id="login-email" placeholder="Email" class="form__input">
                        <input type="password" id="login-password" placeholder="Mật khẩu" class="form__input">
                        <div class="form__btn">
                            <button class="btn" type="submit">Đăng nhập</button>
                        </div>
                    </form>
                </div>
                <div class="register">
                    <h3 class="section__title">Đăng ký</h3>
                    <form onsubmit="addAccount(event)" class="form grid" id="register-form">
                        <input type="text" placeholder="Tên người dùng" class="form__input" id="register-name">
                        <input type="email" placeholder="Email" class="form__input" id="register-email">
                        <input type="password" placeholder="Mật khẩu" class="form__input" id="register-password">
                        <input type="password" placeholder="Xác nhận mật khẩu" class="form__input" id="register-confirm">
                        <div class="form__btn">
                            <button class="btn" type="submit">Đăng ký</button>
                        </div>
                    </form>
                </div>
            </div>
        </section>
    </main>
    <footer class="footer">
        <div class="infor__section">
            <div class="shop-infor-field">
                <div class="shop-infor">
                    <div class="infor-column">
                        <p>VỀ NICE WEAR</p>
                        <a href="">Chúng tôi là ai</a>
                        <a href="">Cam kết của chúng tôi</a>
                        <a href="">Tin tuyển dụng</a>
                        <a href="">Hệ thống của hàng</a>
                    </div>
                    <div class="infor-column">
                        <p>HỖ TRỢ KHÁCH HÀNG</p>
                        <a href="">Hướng dẫn đặt hàng</a>
                        <a href="">Phương thức thanh toán</a>
                        <a href="">Chính sách thành viên</a>
                        <a href="">Chính sách tích - tiêu điểm</a>
                    </div>
                    <div class="infor-column">
                        <p>CHÍNH SÁCH</p>
                        <a href="">Chính sách vận chuyển</a>
                        <a href="">Chính sách kiểm hàng</a>
                        <a href="">Chính sách đổi trả</a>
                        <a href="">Điều kiện và điều khoản</a>
                        <a href="">Chính sách bảo mật</a>
                    </div>
                    <div class="infor-column">
                        <p>LIÊN HỆ</p>
                        <a>Tư vấn mua online: 037 908 0740</a>
                        <a>Khiếu nại bảo hàng: 094 297 6021</a>
                        <a>Email: luongducduy0906@gmail.com</a>
                        <a>Giờ làm việc: 8:30 - 22:00 hàng ngày</a>
                    </div>
                </div>
                <div class="shop-social-media">
                    <p>KẾT NỐI VỚI NICE WEAR</p>
                    <div class="social-link">
                        <button><img src="assets/img/facebook-color-svgrepo-com.svg" alt=""></button>
                        <button><img src="assets/img/instagram-1-svgrepo-com.svg" alt=""></button>
                        <button><img src="assets/img/tiktok-svgrepo-com.svg" alt=""></button>
                        <button><img src="assets/img/youtube-color-svgrepo-com.svg" alt=""></button>
                    </div>
                </div>
            </div>
            <div class="direct-to-shop-field">
                <p>ĐĂNG KÝ NHẬN THÔNG TIN TỪ NEW WEAR</p>
                <div class="email-input">
                    <input class="email" type="text" placeholder="Nhập đại chỉ email">
                    <button class="email-btn">Đăng ký</button>
                </div>
                <div class="payment">
                    Chúng tôi có thể thanh toán qua nhiều phương thức
                </div>
                <div class="payment-grid">
                    <div class="payment-type"><img src="assets/img/images.png" alt=""></div>
                    <div class="payment-type"><img src="assets/img/unnamed.png" alt=""></div>
                    <div class="payment-type"><img src="assets/img/3796142.png" alt=""></div>
                    <div class="payment-type"><img
                            src="assets/img/pngtree-bank-transfer-icon-isolated-commercial-company-vector-png-image_19627424.png"
                            alt="">
                    </div>
                </div>
            </div>
        </div>
        <div class="no__copy">
            <img src="assets/img/ChatGPT Image Jun 14, 2025, 02_08_38 PM change-Photoroom.png" class="logo-footer"
                alt="">
            <p>Copyright &copy; 2014-2025 ITLife.vn All Rights Reserved.</p>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
        function addAccount(event){
            event.preventDefault();

            const name = document.getElementById("register-name").value;
            const email = document.getElementById("register-email").value;
            const password = document.getElementById("register-password").value;
            const confirm = document.getElementById("register-confirm").value;

            if(password != confirm){
                alert("Mật khẩu xác nhận không trùng với mật khẩu bạn điền");
                return;
            }
            else{
                const newAccount = {
                    name,
                    email,
                    password,
                };

                const account = {
                    name,
                    email,
                    password,
                    role: 'user',
                }

                fetch("http://localhost:8080/api/users", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(newAccount)
                    })
                    .then(res => {
                        if (!res.ok) return res.text().then(msg => { throw new Error(msg); });
                        return res.json();
                    })
                    .then(added => {
                        localStorage.setItem('currentUser', JSON.stringify(account));
                        alert("Thêm người dùng thành công!");
                        window.location.href = "accounts.html";
                    })
                    .catch(error => {
                        console.error("Lỗi:", error);
                        alert("Không thể thêm người dùng!");
                    });
            }
        }

        function login(event){
            event.preventDefault();

            const email = document.getElementById("login-email").value;
            const password = document.getElementById("login-password").value;

            const login = {
                email,
                password,
            }

            fetch("http://localhost:8080/api/users/login", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(login)
                })
                .then(res => {
                    if (!res.ok) return res.text().then(msg => { throw new Error(msg); });
                    return res.json();
                })
                .then(user => {
                    alert("Đăng nhập thành công!");
                    localStorage.setItem('currentUser', JSON.stringify(user));
                    const id = user.id;
                    if(user.role === "customer"){
                        window.location.href = "accounts.html";
                    }
                    if(user.role === "admin"){
                        window.location.href = "admin-home.html";
                    }
                })
                .catch(error => {
                    console.error("Lỗi:", error);
                    alert("Không thể thêm người dùng!");
                });
        }
    </script>
</body>

</html>